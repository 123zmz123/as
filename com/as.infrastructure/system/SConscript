from building import *

cwd = GetCurrentDir()

Import('asenv')
MODULES = asenv['MODULES']

objs = []

objs += SConscript('kernel/SConscript')

if('ECUM' in MODULES):
    objs += Glob('EcuM/*.c')
    asenv.Append(CPPPATH=['%s/EcuM'%(cwd)])
    asenv.Append(CPPDEFINES='USE_ECUM')

if('SCHM' in MODULES):
    objs += Glob('SchM/*.c')
    asenv.Append(CPPPATH=['%s/SchM'%(cwd)])
    asenv.Append(CPPDEFINES='USE_SCHM')

if('SG' in MODULES):
    objs += Glob('gui/*.c')
    asenv.Append(CPPPATH=['%s/gui'%(cwd)])
    if('OPENVG' in MODULES):
        asenv.Append(CPPPATH=['%s/gui/openvg/include'%(cwd)])
    asenv.Append(CPPDEFINES=['USE_SG','USE_GUI'])

objs += Glob('Crc/*.c')

objs += SConscript('net/SConscript')
objs += SConscript('fs/SConscript')

if('SHELL' in MODULES):
    objs += Glob('shell/*.c')
    objs += Glob('shell/*.xml')
    asenv.Append(CPPDEFINES='USE_SHELL')

if('CPLUSPLUS' in MODULES):
    asenv.Append(CPPDEFINES=['USE_CPLUSPLUS'])
    objs += Glob('cplusplus/*.cpp')

Return('objs')
